@page "/aircraft"
@inject ICRUDService<AircraftListItem, AircraftItem> _aircraftService
@inject IJSRuntime _jsRuntime

<h1>Vliegtuigen</h1>
<div class="row">
	@foreach (var aircraft in aircrafts)
	{
		<ListItem Model="aircraft"
			OnDeleteClicked="DeleteAsync">
	</ListItem>
	}
</div>

@code {
	private IEnumerable<AircraftListItem> aircrafts = new List<AircraftListItem>();

	protected override async Task OnInitializedAsync()
	{
		await ShowList();
	}

	public async Task ShowList()
	{
		aircrafts = await _aircraftService.ListAllAsync();
	}

	public async Task DeleteAsync(object item)
	{
		bool confirmed = await _jsRuntime.InvokeAsync<bool>("confirm", "Ben je zeker dat je dit vliegtuig wilt verwijderen?");

		if (confirmed)
		{
			AircraftListItem aircraft = item as AircraftListItem;
			await _aircraftService.DeleteAsync(aircraft.Id);
			await ShowList();
		}
	}
}
